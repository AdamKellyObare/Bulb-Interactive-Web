<div class="payment-component">
  <div class="payment-header">
    <h3>Payment Details</h3>
    <div class="amount-display">
      <span class="currency">KES</span>
      <span class="amount">{{amount | number:'1.2-2'}}</span>
    </div>
  </div>

  <div class="payment-methods">
    <h4>Select Payment Method</h4>
    <div class="method-options">
      <div class="method-option" 
           [class.selected]="selectedMethod === 'mpesa'"
           (click)="selectPaymentMethod('mpesa')">
        <div class="method-icon">
          <img src="/assets/images/mpesa-logo.png" alt="M-Pesa" />
        </div>
        <div class="method-info">
          <h5>M-Pesa</h5>
          <p>Pay with your mobile money</p>
        </div>
      </div>

      <div class="method-option" 
           [class.selected]="selectedMethod === 'card'"
           (click)="selectPaymentMethod('card')">
        <div class="method-icon">
          <img src="/assets/images/card-icon.png" alt="Card" />
        </div>
        <div class="method-info">
          <h5>Credit/Debit Card</h5>
          <p>Visa, Mastercard accepted</p>
        </div>
      </div>

      <div class="method-option" 
           [class.selected]="selectedMethod === 'paypal'"
           (click)="selectPaymentMethod('paypal')">
        <div class="method-icon">
          <img src="/assets/images/paypal-logo.png" alt="PayPal" />
        </div>
        <div class="method-info">
          <h5>PayPal</h5>
          <p>Pay with your PayPal account</p>
        </div>
      </div>
    </div>
  </div>

  <div class="payment-form">
    <!-- Common Fields -->
    <div class="form-group">
      <label for="email">Email Address *</label>
      <input 
        type="email" 
        id="email"
        [(ngModel)]="customerEmail"
        class="form-control"
        placeholder="your@email.com"
        required>
    </div>

    <!-- M-Pesa Form -->
    <div *ngIf="selectedMethod === 'mpesa'" class="mpesa-form">
      <div class="form-group">
        <label for="mpesa-phone">M-Pesa Phone Number *</label>
        <input 
          type="tel" 
          id="mpesa-phone"
          [(ngModel)]="mpesaPhone"
          (input)="formatPhone($event)"
          class="form-control"
          placeholder="254712345678"
          required>
        <small class="form-text">Enter your M-Pesa registered phone number</small>
      </div>
    </div>

    <!-- Card Form -->
    <div *ngIf="selectedMethod === 'card'" class="card-form">
      <div class="form-group">
        <label for="cardholder-name">Cardholder Name *</label>
        <input 
          type="text" 
          id="cardholder-name"
          [(ngModel)]="cardholderName"
          class="form-control"
          placeholder="John Doe"
          required>
      </div>

      <div class="form-group">
        <label for="card-number">Card Number *</label>
        <input 
          type="text" 
          id="card-number"
          [value]="cardNumber"
          (input)="formatCardNumber($event)"
          class="form-control"
          placeholder="1234 5678 9012 3456"
          maxlength="19"
          required>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="expiry-date">Expiry Date *</label>
          <input 
            type="text" 
            id="expiry-date"
            [value]="expiryDate"
            (input)="formatExpiryDate($event)"
            class="form-control"
            placeholder="MM/YY"
            maxlength="5"
            required>
        </div>

        <div class="form-group">
          <label for="cvv">CVV *</label>
          <input 
            type="text" 
            id="cvv"
            [(ngModel)]="cvv"
            class="form-control"
            placeholder="123"
            maxlength="4"
            required>
        </div>
      </div>
    </div>

    <!-- PayPal Form -->
    <div *ngIf="selectedMethod === 'paypal'" class="paypal-form">
      <div class="paypal-info">
        <p>You will be redirected to PayPal to complete your payment securely.</p>
      </div>
    </div>

    <!-- Payment Description -->
    <div class="payment-description" *ngIf="description">
      <h5>Payment For:</h5>
      <p>{{description}}</p>
    </div>

    <!-- Payment Button -->
    <div class="payment-actions">
      <button 
        class="btn btn-primary btn-lg payment-btn"
        [disabled]="!isFormValid() || isProcessing"
        (click)="processPayment()">
        <span *ngIf="!isProcessing">
          <i class="fas fa-lock"></i>
          Pay KES {{amount | number:'1.2-2'}}
        </span>
        <span *ngIf="isProcessing">
          <i class="fas fa-spinner fa-spin"></i>
          Processing...
        </span>
      </button>
    </div>

    <!-- Security Notice -->
    <div class="security-notice">
      <i class="fas fa-shield-alt"></i>
      <span>Your payment information is encrypted and secure</span>
    </div>
  </div>
</div>